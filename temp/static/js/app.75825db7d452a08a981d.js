webpackJsonp([1],{"3uQ1":function(e,t){},CVIZ:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"head"}),this._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"menu"},[t("ul",[t("li",[t("router-link",{attrs:{to:"/"}},[this._v("\n            文件上传\n            "),t("i",{staticClass:"el-icon-arrow-right"})])],1),this._v(" "),t("li",[t("router-link",{attrs:{to:"/picUpload/edit"}},[this._v("\n            图片上传\n            "),t("i",{staticClass:"el-icon-arrow-right"})])],1)])]),this._v(" "),t("div",{staticClass:"view"},[t("router-view")],1)])])},staticRenderFns:[]};var l=i("VU/8")({name:"App"},n,!1,function(e){i("3uQ1")},null,null).exports,o=i("/ocq"),r={name:"home",data:function(){return{formInline:{user:"",region:""},tableData:[],totalPage:0,currentPage:null,sizePage:10,tableDataAll:[]}},created:function(){var e=this;$.ajax({url:origin+"admin/files",type:"GET",dataType:"json",success:function(t){e.tableDataAll=t.data.map(function(t){return t.date=e.formatDate(Number(t.date)),t}),e.totalPage=e.tableDataAll.length,e.currentPage=1}})},watch:{currentPage:function(e){this.onSearch(e)}},methods:{deleteFile:function(e){var t=this;$.ajax({url:origin+"deleteFile",type:"GET",data:{id:e},dataType:"json",success:function(i){1===i.errorCode&&(t.$message({message:"恭喜你，操作成功",type:"success"}),t.tableData=t.tableData.filter(function(t){return t.id!==e&&t}))}})},sizeChange:function(e){console.log("size",e)},currentChange:function(e){this.currentPage=e,console.log("currnet",e)},filterList:function(e){var t=[],i=0,a=this.currentPage,n=0;this.currentPage*this.sizePage<e.length?(i=(a-1)*this.sizePage,n=a*this.sizePage):(i=(a-1)*this.sizePage,n=e.length),console.log(this.currentPage,n);for(var l=i;l<n;l++)e[l]&&t.push(e[l]);this.tableData=t},onSearch:function(e){var t=this,i=this.formInline.user,a=this.formInline.region,n=this.formInline.content,l=this;this.currentPage="number"==typeof e?e:1,this.tableData=[],setTimeout(function(){var e=l.tableDataAll.filter(function(e){return!(i&&!(e.title.indexOf(i)>-1)||a&&a!==e.path||n&&!(e.content.indexOf(n)>-1))&&e});t.totalPage=e.length,t.filterList(e)},0)},formatDate:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},onResize:function(){this.formInline.region="",this.formInline.user="",this.formInline.content=""},handleClick:function(e){console.log(e)}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileUpload"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[i("el-form-item",{attrs:{label:"搜索条件"}},[i("el-select",{attrs:{placeholder:"菜单按钮"},model:{value:e.formInline.region,callback:function(t){e.$set(e.formInline,"region",t)},expression:"formInline.region"}},[i("el-option",{attrs:{label:"所有",value:""}}),e._v(" "),i("el-option",{attrs:{label:"课题组概况",value:"课题组概况"}}),e._v(" "),i("el-option",{attrs:{label:"新闻动态",value:"新闻动态"}}),e._v(" "),i("el-option",{attrs:{label:"基金项目",value:"基金项目"}}),e._v(" "),i("el-option",{attrs:{label:"学术成果",value:"学术成果"}}),e._v(" "),i("el-option",{attrs:{label:"文娱体育",value:"文娱体育"}}),e._v(" "),i("el-option",{attrs:{label:"资源共享",value:"资源共享"}}),e._v(" "),i("el-option",{attrs:{label:"通知公告",value:"通知公告"}}),e._v(" "),i("el-option",{attrs:{label:"科研团队",value:"科研团队"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"标题搜索"}},[i("el-input",{attrs:{placeholder:"请输入标提搜索"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"内容搜索"}},[i("el-input",{attrs:{placeholder:"请输入内容搜索"},model:{value:e.formInline.content,callback:function(t){e.$set(e.formInline,"content",t)},expression:"formInline.content"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),e._v(" "),i("router-link",{attrs:{to:"/fileUpload/edit"}},[i("el-button",{attrs:{type:"primary"}},[e._v("新增")])],1),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.onResize}},[e._v("清空")])],1)],1),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"发布标题",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"content",label:"发布内容",width:"250"}}),e._v(" "),i("el-table-column",{attrs:{prop:"path",label:"发布路径",width:"120"}}),e._v(" "),i("el-table-column",{attrs:{prop:"create_name",label:"发布人",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"date",label:"发布时间",width:"180"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("router-link",{attrs:{to:"/fileUpload/edit?id="+t.row.id+"&view=1"}},[i("el-button",{attrs:{type:"text",size:"small"}},[e._v("查看")])],1),e._v(" "),i("router-link",{attrs:{to:"/fileUpload/edit?id="+t.row.id}},[i("el-button",{attrs:{type:"text",size:"small"}},[e._v("编辑")])],1),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.deleteFile(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.totalPage},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},staticRenderFns:[]};var c=i("VU/8")(r,s,!1,function(e){i("mR/D")},"data-v-2df3d32c",null).exports,u=i("sYY+"),f=i.n(u),d={name:"home",data:function(){return{fileList:[],origin:origin,disabled:!!this.$route.query.view,dataUrl:{edit_file:origin+"edit_file"},editorContent:"",file_types:["jpg","png","pdf"],form:{file_type:"1",file_url:"",title:"",filename:"",path:"",create_name:"",content:"",originName:""}}},mounted:function(){var e=this;this.$route.query.id&&this.getEditInfo(this.$route.query.id),window.editor=new f.a(this.$refs.editor),editor.customConfig.onchange=function(t){e.editorContent=t},editor.create()},methods:{goList:function(){this.$router.push("/")},getEditInfo:function(e){var t=this;$.ajax({url:this.dataUrl.edit_file,data:{id:e},type:"GET",dataType:"JSON",success:function(e){if(1===e.errorCode){var i=e.data[0];if(t.form=i,1==i.file_type){var a=i.file_url.split(","),n=i.origin_name.split(",");t.fileList=i.file_name.split(",").map(function(e,t){location.origin.indexOf("127.0.0.1")>-1||location.origin;return{name:e,originName:n[t],url:a[t]}}),console.log(t.fileList)}else editor.txt.html(e.data[0].file_name)}else t.$message.warning(e.errorMessage)}})},handleRemove:function(e,t){this.fileList=t},beforeUpload:function(e){var t=!1;return this.file_types.every(function(i){return!(e.name.toLocaleLowerCase().indexOf("."+i)>-1)||(t=1,!1)}),t},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},onSuccess:function(e,t,i){i.forEach(function(i){i.name===t.name&&(i.url=/\.pdf$/.test(e.url)?origin+"uploads/timg.jpg":origin+"uploads/"+e.url,i.originName=e.name)}),this.fileList=i},onSubmit:function(){var e=this;this.form.filename=this.fileList.map(function(e){return e.name}).join(","),this.form.file_url=this.fileList.map(function(e){return e.url}).join(","),this.form.originName=this.fileList.map(function(e){return e.originName}).join(",");var t=this.form;switch(t.file_type){case"1":break;case"2":t.htmlContent=this.editorContent}this.$route.query.id&&this.$route.query.id.length>0?t.saveType="edit":t.saveType="add",$.ajax({url:origin+"admin/save_file",type:"POST",data:t,dataType:"json",success:function(t){1===t.errorCode?(e.$message({message:"恭喜你，操作成功",type:"success"}),e.$router.go(-1)):e.$message.error(t.errorMessage)}})}}},m={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"发布文件"}},[i("el-radio",{attrs:{label:"1",disabled:e.disabled},model:{value:e.form.file_type,callback:function(t){e.$set(e.form,"file_type",t)},expression:"form.file_type"}},[e._v("图片")]),e._v(" "),i("el-radio",{attrs:{label:"2",disabled:e.disabled},model:{value:e.form.file_type,callback:function(t){e.$set(e.form,"file_type",t)},expression:"form.file_type"}},[e._v("文件")]),e._v(" "),i("el-upload",{directives:[{name:"show",rawName:"v-show",value:1==e.form.file_type,expression:"form.file_type == 1"}],staticClass:"upload-demo",staticStyle:{width:"350px"},attrs:{"before-upload":e.beforeUpload,action:e.origin+"admin/upload/","on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.onSuccess,"before-remove":e.beforeRemove,multiple:"",disabled:e.disabled,limit:20,"on-exceed":e.handleExceed,"list-type":"picture","file-list":e.fileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持扩展名：jpg , png, pdf")])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:2==e.form.file_type,expression:"form.file_type == 2"}],ref:"editor",staticStyle:{"text-align":"left"}}),e._v(" "),e.disabled&&2==e.form.file_type?i("div",{staticClass:"editor-disabled"}):e._e()],1),e._v(" "),i("el-form-item",{attrs:{label:"发布路径"}},[i("el-select",{attrs:{placeholder:"",disabled:e.disabled},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}},[i("el-option",{attrs:{label:"课题组概况",value:"课题组概况"}}),e._v(" "),i("el-option",{attrs:{label:"新闻动态",value:"新闻动态"}}),e._v(" "),i("el-option",{attrs:{label:"基金项目",value:"基金项目"}}),e._v(" "),i("el-option",{attrs:{label:"学术成果",value:"学术成果"}}),e._v(" "),i("el-option",{attrs:{label:"文娱体育",value:"文娱体育"}}),e._v(" "),i("el-option",{attrs:{label:"资源共享",value:"资源共享"}}),e._v(" "),i("el-option",{attrs:{label:"通知公告",value:"通知公告"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"发布标题"}},[i("el-input",{attrs:{disabled:e.disabled},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发布人"}},[i("el-input",{attrs:{disabled:e.disabled},model:{value:e.form.create_name,callback:function(t){e.$set(e.form,"create_name",t)},expression:"form.create_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发布内容"}},[i("el-input",{attrs:{type:"textarea",rows:"10",disabled:e.disabled},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),i("el-form-item",[i("el-button",{on:{click:e.goList}},[e._v("放弃")]),e._v(" "),e.disabled?e._e():i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var p=i("VU/8")(d,m,!1,function(e){i("CVIZ"),i("SsHR")},"data-v-6f57820c",null).exports,v={name:"home",data:function(){return{fileList:[],origin:origin,dataUrl:{edit_file:origin+"admin/edit_file"},fileTypes:["jpg","png"],bannerData:[{text:"",filename:"",sort:0},{text:"",filename:"",sort:1},{text:"",filename:"",sort:2},{text:"",filename:"",sort:3},{text:"",filename:"",sort:4},{text:"",filename:"",sort:5}]}},mounted:function(){this.getBannerData()},methods:{resize:function(e){this.bannerData[e].url="",this.bannerData[e].text="",this.bannerData[e].filename=""},changeSort:function(){},goList:function(){this.$router.push("/")},handleRemove:function(e,t){console.log(e,t)},beforeUpload:function(e){var t=!1;return this.fileTypes.every(function(i){return!(e.name.indexOf("."+i)>-1)||(t=1,!1)}),t},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},onSuccess:function(e){this.$set(this.bannerData[e.sort],"filename",e.url),this.$set(this.bannerData[e.sort],"url",origin+"uploads/"+e.url)},getBannerData:function(){var e=this;$.ajax({url:origin+"getBanner",type:"GET",dataType:"json",success:function(t){1===t.errorCode&&(e.bannerData=t.data.map(function(e){return{filename:e.url,sort:e.sort,url:e.url?origin+"uploads/"+e.url:null,text:e.text||""}}))}})},onSubmit:function(){var e=this,t=this.bannerData.filter(function(e){return e});$.ajax({url:origin+"saveBanner",type:"GET",data:{data:t},dataType:"json",success:function(t){1===t.errorCode&&(alert("修改成功"),e.$message({message:"恭喜你，操作成功",type:"success"}))}})}}},h={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pic"},[e._m(0),e._v(" "),e._l(e.bannerData,function(t,a){return i("div",{staticClass:"pic-item clearfix"},[i("div",{staticClass:"pic-item-upload"},[i("el-upload",{staticClass:"upload-demo",attrs:{data:{sort:t.sort},"before-upload":e.beforeUpload,action:e.origin+"admin/upload/","on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.onSuccess,"before-remove":e.beforeRemove,"on-exceed":e.handleExceed}},[t.url?i("img",{staticStyle:{width:"150px"},attrs:{src:t.url,alt:""}}):i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),i("div",{staticClass:"pic-item-text"},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.text,callback:function(i){e.$set(t,"text",i)},expression:"item.text"}})],1),e._v(" "),i("div",{staticClass:"pic-item-sort"},[i("span",[e._v(e._s(a+1))])]),e._v(" "),i("div",{staticClass:"pic-item-opt"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.resize(a)}}},[e._v("清空")])],1)])}),e._v(" "),i("p",{staticClass:"pic-tip el-upload__tip"},[e._v(" 支持图片类型：JPG PNG 尺寸：1200x500")]),e._v(" "),i("div",{staticClass:"pic-btn"},[i("el-button",{on:{click:e.goList}},[e._v("放弃")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pic-attr clearfix"},[t("p",{staticClass:"pic-item-upload"},[this._v("上传照片")]),this._v(" "),t("p",{staticClass:"pic-item-text"},[this._v("照片说明")]),this._v(" "),t("p",{staticClass:"pic-item-sort"},[this._v("排序展示")]),this._v(" "),t("p",{staticClass:"pic-item-opt"},[this._v("操作")])])}]};var _=i("VU/8")(v,h,!1,function(e){i("ORfS")},"data-v-684f36d8",null).exports;a.default.use(o.a);var b=new o.a({routes:[{path:"/",name:"首页",component:c},{path:"/fileUpload/edit",name:"编辑",component:p},{path:"/picUpload/edit",name:"轮播图管理",component:_}]}),g=i("zL8q"),y=i.n(g);i("tvR6");a.default.use(y.a),a.default.config.productionTip=!1,window.NODE_ENV="production",window.origin="production"===NODE_ENV?"/":"//127.0.0.1/",new a.default({el:"#app",router:b,components:{App:l},template:"<App/>"})},ORfS:function(e,t){},SsHR:function(e,t){},"mR/D":function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.75825db7d452a08a981d.js.map